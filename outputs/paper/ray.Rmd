---
title: "ray"
author: "Ray Wen"
date: "3/18/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(haven)
library(tidyverse)
library(ggplot2)
library("readxl")
library(dplyr)
library(tidyverse)
library(vtable)

```

Load Data
```{r}
raw_data <- read.csv("../data/raw_gss.csv")
```


plot
```{r}
# Mental Health Male vs Female

male_female_mental <- raw_data %>% select(c(hlthmntl, sex)) %>%
  mutate(sex = case_when(
    sex == 1 ~ "Male",
    sex == 2 ~ "Female",
    sex == 3 ~ "Transgender",
    sex == 4 ~ "None of these",
  )) %>% group_by(sex)

male_female_mental %>% ggplot(aes(x=hlthmntl, fill=sex)) +
  geom_histogram(aes(y = ..density..), position = 'dodge')
```


mental health vs age groups

```{r}
age_group <- raw_data %>% select(c(hlthmntl, age)) %>%
  mutate(age = case_when(
    age < 20 ~ "< 20",
    age < 30 ~ "< 30",
    age < 40 ~ "< 40",
    age < 50 ~ "< 50",
    age < 60 ~ "< 60",
    age >= 60 ~ ">= 60",
  )) %>% group_by(age)

age_group %>% ggplot(aes(x=hlthmntl, fill=age)) +
  geom_histogram(aes(y = ..density..), position = 'dodge')
```

Mental vs physical 

```{r}
mental_phsy <- raw_data %>% select(c(hlthmntl, hlthphys, age, sex)) %>%
  mutate(age = case_when(
    age < 20 ~ "< 20",
    age < 30 ~ "< 30",
    age < 40 ~ "< 40",
    age < 50 ~ "< 50",
    age < 60 ~ "< 60",
    age >= 60 ~ ">= 60",
  )) %>%
  mutate(sex = case_when(
    sex == 1 ~ "Male",
    sex == 2 ~ "Female",
    sex == 3 ~ "Transgender",
    sex == 4 ~ "None of these",
  ))

mental_phsy  %>% ggplot(aes(x=hlthmntl, y=hlthphys)) +
  geom_point(aes(color=age), position = 'dodge')
  
```


sexual orientation

```{r}
sexornt_data <- raw_data %>% select(c(sexornt, hlthmntl)) %>% filter(!is.na(sexornt), !is.na(hlthmntl)) %>%
  mutate(sexornt = case_when(
    sexornt <= 2 ~ "LGBTQ+",
    sexornt == 3 ~ "Heterosexual",
  )) %>%
  mutate(mntl_poor = case_when(
    hlthmntl <= 3 ~ 'Good',
    hlthmntl >= 4 ~ 'Not Good',
  ))

sexornt_data %>% ggplot(aes(x= mntl_poor,  group=sexornt))+
  geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
  geom_text(aes( label = scales::percent(..prop..),
                 y= ..prop.. ), stat= "count", vjust = -.5) +
  labs(y = "Percent", fill="mntl_poor") +
  facet_grid(~sexornt) +
  scale_y_continuous(labels = scales::percent)
```


























